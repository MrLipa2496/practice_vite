import{_,c as i,a as p,d as f,b as a,r as h,e as m,v as g,h as $,F as w,i as F,f as v,o as d,w as S,t as c,n as k}from"./index-Bwrb5_4_.js";import{H as C,l as V}from"./loader-D2qkesDV.js";import{P}from"./Msg-DfQ1Tyd-.js";import{T as I}from"./Toogle-A8qWsdET.js";const L={name:"Sites",components:{Header:C,Popup:P,Toogle:I},data:function(){return{parent:{formData:{},user:{id:"",auth:""},url:""},loaderImg:V,data:{items:[]},date:"",date2:"",loader:1}},mounted:function(){const t=this.findParent();t&&(this.parent=t),this.parent.user&&!this.parent.user.auth?typeof this.parent.logout=="function"&&this.parent.logout():(this.GetFirstAndLastDate(),this.get())},methods:{findParent(){let t=this.$parent;for(;t;){if(t.url||t.user&&t.user.auth)return t;t=t.$parent}return this.$root&&(this.$root.url||this.$root.user)?this.$root:null},toFormData(t){const e=new FormData;if(!t)return e;for(let r in t)e.append(r,t[r]);return e},GetFirstAndLastDate:function(){var t=new Date().getFullYear(),e=new Date().getMonth(),r=new Date(t,e,2),n=new Date(t,e+1,1);this.date=r.toISOString().substring(0,10),this.date2=n.toISOString().substring(0,10)},get:function(){var t=this,e=this.toFormData(t.parent.formData);const r=this.parent.user?this.parent.user.id:"";e.append("uid",r),this.date!=""&&e.append("date",this.date),this.date2!=""&&e.append("date2",this.date2),t.loader=1;const n=this.parent.url||"",l=this.parent.user?this.parent.user.auth:"";if(!n){t.loader=0;return}v.post(n+"/site/getSites?auth="+l,e).then(function(o){if(t.loader=0,o.data.error){const u=t.$refs.header?.$refs?.msg;return u&&u.alertFun(o.data.error),!1}t.data=o.data}).catch(function(o){console.error(o),t.parent.logout&&t.parent.logout(),t.loader=0})},action:function(){var t=this,e=this.toFormData(t.parent.formData);const r=this.parent.url||"",n=this.parent.user?this.parent.user.auth:"";v.post(r+"/site/actionSite?auth="+n,e).then(function(l){const o=t.$refs.header?.$refs?.msg;if(l.data.error)return o&&o.alertFun(l.data.error),!1;if(o){const u=t.parent.formData.id?"Successfully updated site!":"Successfully added new site!";o.successFun(u)}t.get()}).catch(function(l){console.log("errors: ",l)})},copy:async function(t){if(navigator&&navigator.clipboard){await navigator.clipboard.writeText(t);const e=this.$refs.header?.$refs?.msg;e&&e.successFun("Successfully copied!"),this.$refs.copy&&(this.$refs.copy.active=0)}else{const e=this.$refs.header?.$refs?.msg;e&&e.alertFun("Use https!")}}}},T={class:"page-container"},U={key:0,id:"spinner"},M=["src"],H={class:"content-wrapper"},N={class:"toolbar"},O={class:"toolbar-center"},B={class:"date-group"},A={class:"form-container"},G={key:0},z={class:"form-group"},E={class:"form-actions"},Y={key:0,class:"table-container"},q={class:"data-table"},J={class:"col-toggle","data-label":"Status"},K={class:"col-title","data-label":"Site"},Q={class:"col-stat","data-label":"Views"},R={class:"col-stat","data-label":"Clicks"},W={class:"col-stat","data-label":"Leads"},X={class:"col-stat","data-label":"Fraud"},Z={key:1,class:"empty-state"};function j(t,e,r,n,l,o){const u=h("Header"),y=h("Popup"),b=h("Toogle");return d(),i("div",T,[p(u,{ref:"header"},null,512),t.loader?(d(),i("div",U,[a("img",{src:t.loaderImg,alt:"Loading..."},null,8,M)])):f("",!0),a("div",H,[a("div",N,[e[7]||(e[7]=a("div",{class:"toolbar-left"},[a("h1",{class:"page-title"},"Sites")],-1)),a("div",O,[a("div",B,[m(a("input",{type:"date",class:"date-input","onUpdate:modelValue":e[0]||(e[0]=s=>t.date=s),onChange:e[1]||(e[1]=s=>o.get())},null,544),[[g,t.date]]),e[6]||(e[6]=a("span",{class:"date-separator"},"-",-1)),m(a("input",{type:"date",class:"date-input","onUpdate:modelValue":e[2]||(e[2]=s=>t.date2=s),onChange:e[3]||(e[3]=s=>o.get())},null,544),[[g,t.date2]])])]),e[8]||(e[8]=a("div",{class:"toolbar-right"},null,-1))]),p(y,{ref:"copy",title:"Copy banner"},{default:$(()=>[a("div",A,[t.parent.formData?(d(),i("form",G,[a("div",z,[e[9]||(e[9]=a("label",null,"Code",-1)),m(a("textarea",{class:"text-input",style:{height:"120px","font-family":"monospace"},"onUpdate:modelValue":e[4]||(e[4]=s=>t.parent.formData.copy=s)},null,512),[[g,t.parent.formData.copy]])]),a("div",E,[a("button",{class:"btn-primary",onClick:e[5]||(e[5]=S(s=>o.copy(t.parent.formData.copy),["prevent"]))}," Copy code ")])])):f("",!0)])]),_:1},512),t.data.items&&t.data.items.length>0?(d(),i("div",Y,[a("table",q,[e[10]||(e[10]=a("thead",null,[a("tr",null,[a("th",{class:"col-toggle"}),a("th",{class:"col-title"},"Site"),a("th",{class:"col-stat"},"Views"),a("th",{class:"col-stat"},"Clicks"),a("th",{class:"col-stat"},"Leads"),a("th",{class:"col-stat"},"Fraud")])],-1)),a("tbody",null,[(d(!0),i(w,null,F(t.data.items,s=>(d(),i("tr",{key:s.id},[a("td",J,[p(b,{modelValue:s.published,"onUpdate:modelValue":D=>{s.published=D,t.parent.formData=s,o.action()}},null,8,["modelValue","onUpdate:modelValue"])]),a("td",K,c(s.site),1),a("td",Q,c(s.views),1),a("td",R,c(s.clicks||0),1),a("td",W,c(s.leads||0),1),a("td",X,[a("span",{class:k({"text-danger":s.fclicks>0})},c(s.fclicks||0),3)])]))),128))])])])):t.loader?f("",!0):(d(),i("div",Z,"No items found"))])])}const st=_(L,[["render",j],["__scopeId","data-v-24e5682f"]]);export{st as default};
