import{_ as N,c as n,a as d,d as y,b as a,r as m,w as c,g as k,h as v,F,i as U,f as D,o as l,e as p,v as h,t as f,j as S}from"./index-Bwrb5_4_.js";import{H as T,l as _}from"./loader-D2qkesDV.js";import{P as E}from"./Msg-DfQ1Tyd-.js";import{T as q}from"./Toogle-A8qWsdET.js";const H={name:"Users",components:{Header:T,Popup:E,Toogle:q},data:function(){return{parent:{formData:{},user:{auth:""},url:"",toFormData:t=>{const e=new FormData;for(let r in t)e.append(r,t[r]);return e}},data:{items:[],types:[]},loader:1,type:0,uid:-1}},mounted:function(){const t=this.findParent();t&&(this.parent=t),this.parent.user&&!this.parent.user.auth?typeof this.parent.logout=="function"&&this.parent.logout():this.get()},methods:{findParent(){let t=this.$parent;for(;t;){if(t.url||t.user&&t.user.auth)return t;t=t.$parent}return this.$root&&(this.$root.url||this.$root.user)?this.$root:null},toFormData(t){const e=new FormData;if(!t)return e;for(let r in t)e.append(r,t[r]);return e},get:function(){var t=this;t.parent.formData||(t.parent.formData={});var e=this.toFormData(t.parent.formData);this.type!=""&&e.append("type",this.type),t.loader=1;const r=this.parent.url||"",u=this.parent.user?this.parent.user.auth:"";if(!r){this.loader=0;return}D.post(r+"/site/getUsers?auth="+u,e).then(function(o){t.loader=0,t.data=o.data,o.data.types&&o.data.types[0]&&!t.type&&(t.type=o.data.types[0].id),t.uid>-1&&t.data.items&&(t.parent.formData.copy=t.data.items[t.uid].multi)}).catch(function(o){t.parent.logout&&t.parent.logout(),t.loader=0})},action:function(){var t=this;if(!t.parent.formData)return;var e=this.toFormData(t.parent.formData);const r=this.parent.url||"",u=this.parent.user?this.parent.user.auth:"";D.post(r+"/site/actionUser?auth="+u,e).then(function(o){if(o.data.error)t.$refs.header.$refs.msg.alertFun(o.data.error);else{t.$refs.new&&(t.$refs.new.active=0);const i=t.parent.formData.id?"Successfully updated user!":"Successfully added new user!";t.$refs.header.$refs.msg.successFun(i),t.get()}}).catch(function(o){console.log("errors",o)})},del:async function(){if(await this.$refs.header.$refs.msg.confirmFun("Please confirm","Delete this user?")){var t=this,e=this.toFormData(t.parent.formData);const r=this.parent.url||"",u=this.parent.user?this.parent.user.auth:"";D.post(r+"/site/deleteUser?auth="+u,e).then(function(o){o.data.error?t.$refs.header.$refs.msg.alertFun(o.data.error):(t.$refs.header.$refs.msg.successFun("Successfully deleted user!"),t.get())})}},copy:async function(t){navigator&&navigator.clipboard?(await navigator.clipboard.writeText(t),this.$refs.header.$refs.msg.successFun("Successfully copied!"),this.$refs.copy&&(this.$refs.copy.active=0),this.parent.formData={}):this.$refs.header.$refs.msg.alertFun("Use https!")}}},A={class:"page-container"},B={key:0,id:"spinner"},I={class:"content-wrapper"},M={class:"toolbar"},L={class:"toolbar-center"},z={class:"toolbar-right"},G={class:"form-container"},J={class:"form-group"},K={class:"form-group"},O={class:"form-group"},Q={class:"form-group"},R={class:"form-actions"},W={class:"btn-primary"},X={class:"form-container"},Y={key:0},Z={class:"form-group"},j={class:"form-group"},x=["value"],tt={class:"form-actions"},et={key:0,class:"table-container"},at={class:"data-table"},st={class:"col-id","data-label":"ID"},ot={class:"col-toggle","data-label":"Status"},rt={class:"col-title","data-label":"Name"},nt={"data-label":"Phone"},lt={"data-label":"Email"},it={class:"col-actions","data-label":"Actions"},dt=["onClick"],ut=["onClick"],pt={key:1,class:"empty-state"};function ft(t,e,r,u,o,i){const V=m("Header"),C=m("search"),$=m("Popup"),P=m("Toogle"),b=m("router-link");return l(),n("div",A,[d(V,{ref:"header"},null,512),t.loader?(l(),n("div",B,[...e[10]||(e[10]=[a("img",{src:_,alt:"Loading..."},null,-1)])])):y("",!0),a("div",I,[a("div",M,[e[12]||(e[12]=a("div",{class:"toolbar-left"},[a("h1",{class:"page-title"},"Users")],-1)),a("div",L,[d(C)]),a("div",z,[a("a",{class:"btn-primary",href:"#",onClick:e[0]||(e[0]=c(s=>{t.parent.formData={},t.$refs.new.active=1},["prevent"]))},[...e[11]||(e[11]=[a("i",{class:"fas fa-plus"},null,-1),k(" New ",-1)])])])]),d($,{ref:"new",title:t.parent.formData&&t.parent.formData.id?"Edit user":"New user"},{default:v(()=>[a("div",G,[t.parent.formData?(l(),n("form",{key:0,onSubmit:e[5]||(e[5]=c(s=>i.action(),["prevent"]))},[a("div",J,[e[13]||(e[13]=a("label",null,"Name",-1)),p(a("input",{type:"text",class:"text-input","onUpdate:modelValue":e[1]||(e[1]=s=>t.parent.formData.user=s),required:""},null,512),[[h,t.parent.formData.user]])]),a("div",K,[e[14]||(e[14]=a("label",null,"Phone",-1)),p(a("input",{type:"text",class:"text-input","onUpdate:modelValue":e[2]||(e[2]=s=>t.parent.formData.phone=s),required:""},null,512),[[h,t.parent.formData.phone]])]),a("div",O,[e[15]||(e[15]=a("label",null,"Email",-1)),p(a("input",{type:"text",class:"text-input","onUpdate:modelValue":e[3]||(e[3]=s=>t.parent.formData.email=s),required:""},null,512),[[h,t.parent.formData.email]])]),a("div",Q,[e[16]||(e[16]=a("label",null,"Password",-1)),p(a("input",{type:"text",class:"text-input","onUpdate:modelValue":e[4]||(e[4]=s=>t.parent.formData.password=s)},null,512),[[h,t.parent.formData.password]])]),a("div",R,[a("button",W,f(t.parent.formData.id?"Edit":"Add"),1)])],32)):y("",!0)])]),_:1},8,["title"]),d($,{ref:"copy",title:"Copy banner"},{default:v(()=>[a("div",X,[t.parent.formData?(l(),n("form",Y,[a("div",Z,[e[17]||(e[17]=a("label",null,"Code",-1)),p(a("textarea",{class:"text-input",style:{height:"100px"},"onUpdate:modelValue":e[6]||(e[6]=s=>t.parent.formData.copy=s)},null,512),[[h,t.parent.formData.copy]])]),a("div",j,[e[19]||(e[19]=a("label",null,"Type",-1)),p(a("select",{class:"text-input","onUpdate:modelValue":e[7]||(e[7]=s=>t.type=s),onChange:e[8]||(e[8]=s=>i.get()),required:""},[e[18]||(e[18]=a("option",{value:"0"},null,-1)),(l(!0),n(F,null,U(t.data.types,s=>(l(),n("option",{key:s.id,value:s.id},f(s.title),9,x))),128))],544),[[S,t.type]])]),a("div",tt,[a("button",{class:"btn-primary",onClick:e[9]||(e[9]=c(s=>i.copy(t.parent.formData.copy),["prevent"]))}," Copy code ")])])):y("",!0)])]),_:1},512),t.data.items&&t.data.items.length>0?(l(),n("div",et,[a("table",at,[e[23]||(e[23]=a("thead",null,[a("tr",null,[a("th",{class:"col-id"},"#"),a("th",{class:"col-toggle"}),a("th",{class:"col-title"},"Name"),a("th",null,"Phone"),a("th",null,"Email"),a("th",{class:"col-actions"},"Actions")])],-1)),a("tbody",null,[(l(!0),n(F,null,U(t.data.items,(s,w)=>(l(),n("tr",{key:s.id||w},[a("td",st,f(s.id),1),a("td",ot,[d(P,{modelValue:s.published,"onUpdate:modelValue":g=>{s.published=g,t.parent.formData=s,i.action()}},null,8,["modelValue","onUpdate:modelValue"])]),a("td",rt,[d(b,{to:"/user/"+s.id,class:"link-primary"},{default:v(()=>[k(f(s.user),1)]),_:2},1032,["to"])]),a("td",nt,f(s.phone),1),a("td",lt,f(s.email),1),a("td",it,[d(b,{to:"/user/"+s.id,class:"action-icon"},{default:v(()=>[...e[20]||(e[20]=[a("i",{class:"fas fa-edit"},null,-1)])]),_:1},8,["to"]),a("a",{href:"#",class:"action-icon",onClick:c(g=>{t.parent.formData.copy=s.multi,t.uid=w,t.$refs.copy.active=1},["prevent"])},[...e[21]||(e[21]=[a("i",{class:"fas fa-images"},null,-1)])],8,dt),a("a",{href:"#",class:"icon-delete",onClick:c(g=>{t.parent.formData=s,i.del()},["prevent"])},[...e[22]||(e[22]=[a("i",{class:"fas fa-trash-alt"},null,-1)])],8,ut)])]))),128))])])])):t.loader?y("",!0):(l(),n("div",pt,"No items found"))])])}const vt=N(H,[["render",ft],["__scopeId","data-v-7ac79e0d"]]);export{vt as default};
